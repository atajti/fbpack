\name{get_user_friends}
\alias{get_user_friends}
%- Also NEED an '\alias' for EACH other topic documented here.
\title{
%%  ~~function to do ... ~~
}
\description{
%%  ~~ A concise (1-5 lines) description of what the function does. ~~
}
\usage{
get_user_friends(user, login_name, login_password)
}
%- maybe also 'usage' for other objects documented here.
\arguments{
  \item{user}{
%%     ~~Describe \code{user} here~~
}
  \item{login_name}{
%%     ~~Describe \code{login_name} here~~
}
  \item{login_password}{
%%     ~~Describe \code{login_password} here~~
}
}
\details{
%%  ~~ If necessary, more details than the description above ~~
}
\value{
%%  ~Describe the value returned
%%  If it is a LIST, use
%%  \item{comp1 }{Description of 'comp1'}
%%  \item{comp2 }{Description of 'comp2'}
%% ...
}
\references{
%% ~put references to the literature/web site here ~
}
\author{
%%  ~~who you are~~
}
\note{
%%  ~~further notes~~
}

%% ~Make other sections like Warning with \section{Warning }{....} ~

\seealso{
%% ~~objects to See Also as \code{\link{help}}, ~~~
}
\examples{
##---- Should be DIRECTLY executable !! ----
##-- ==>  Define data, use random,
##--	or do  help(data=index)  for the standard data sets.

## The function is currently defined as
function (user, login_name, login_password) 
{
    get_friend_list <- function(remDr) {
        user_friends <- remDr$findElements(using = "xpath", "//*/a[@class = '_5q6s _8o _8t lfloat _ohe']")
        f_links <- sapply(user_friends, function(friend) {
            friend$getElementAttribute("href")
        })
        return(unlist(f_links))
    }
    scan_all_friends <- function(remDr, txt_progress = NULL) {
        s0 <- NULL
        s1 <- get_friend_list(remDr)
        while (!identical(s0, s1)) {
            s0 <- s1
            for (i in 1:30) {
                tryCatch(remDr$executeScript("window.scrollBy(0,2000)"), 
                  error = function(e) {
                    NULL
                  }, warning = function(w) {
                    NULL
                  })
            }
            Sys.sleep(0.5)
            Sys.sleep(2)
            s1 <- get_friend_list(remDr)
            if (!is.null(txt_progress)) {
                setTxtProgressBar(txt_progress, length(s1))
            }
            else {
                message(paste("Collected", length(s1), "friends"))
            }
            gc()
        }
        return(s1)
    }
    remDr <- remoteDriver(remoteServerAddr = "localhost", port = 4444, 
        browserName = "firefox")
    remDr$open()
    remDr$setImplicitWaitTimeout(5000)
    remDr$setTimeout("page load", 10000)
    remDr$navigate("http://www.facebook.com")
    webElem <- remDr$findElement(using = "xpath", "//*/input[@id = 'email']")
    webElem$sendKeysToElement(list(login_name, key = "tab"))
    webElem <- remDr$findElement(using = "xpath", "//*/input[@id = 'pass']")
    webElem$sendKeysToElement(list(login_password, key = "enter"))
    while (!exists("login_done")) {
        tryCatch({
            login_done <- remDr$findElement(using = "xpath", 
                "//*/div[@class = 'clearfix']")
        }, error = function(e) {
            NULL
        }, warning = function(w) {
            NULL
        })
    }
    if (is.na(suppressWarnings(as.numeric(user)))) {
        remDr$navigate(paste0("http://facebook.com/", user, "/friends"))
    }
    else {
        remDr$navigate(paste0("https://facebook.com/profile.php?id=", 
            user, "&sk=friends"))
    }
    message("Scanning friends of user ", user, " @ ", Sys.time())
    ego_friends <- scan_all_friends(remDr)
    f_list <- unname(sapply(ego_friends, function(link) {
        ifelse(grepl("profile.php?", link, fix = TRUE), strsplit(substring(link, 
            41), split = "&", fixed = TRUE)[[1]][1], strsplit(strsplit(link, 
            split = "/")[[1]][4], split = "?", fixed = TRUE)[[1]][1])
    }))
    log_out_element <- remDr$findElement(using = "id", value = "pageLoginAnchor")
    log_out_element$clickElement()
    log_out_form <- remDr$findElement(using = "id", value = "logout_form")
    log_out_form$submitElement()
    remDr$close()
    remDr$closeServer()
    return(f_list)
  }
}
% Add one or more standard keywords, see file 'KEYWORDS' in the
% R documentation directory.
\keyword{ ~kwd1 }
\keyword{ ~kwd2 }% __ONLY ONE__ keyword per line
